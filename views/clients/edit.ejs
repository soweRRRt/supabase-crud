<%- include('../partials/header', { title: "Редактировать клиента", user }) %>

<div class="container py-5">
  <h1 class="mb-4">Редактирование клиента</h1>

  <form action="/clients/<%= client.id %>?_method=PUT" method="POST" class="card p-4 shadow-sm" onsubmit="return validateForm(event)">
    <div class="mb-3">
      <label class="form-label">ФИО:</label>
      <input class="form-control" type="text" name="full_name" value="<%= client.full_name %>" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Номер телефона:</label>
      <input class="form-control" type="text" name="phone_number" value="<%= client.phone_number %>"
             placeholder="+79123456789"
             oninput="formatPhoneNumber(this)"
             onblur="validatePhoneNumber(this)"
             pattern="^\\+\\d{11}$"
             required>
      <div class="form-text">Формат: +79123456789 (ровно 11 цифр после знака +)</div>
    </div>

    <div class="mb-3">
      <label class="form-label">Статус:</label>
      <select class="form-select" name="status_id" required>
        <option value="">Выберите статус</option>
        <% statuses.forEach(s => { %>
          <option value="<%= s.id %>" <%= s.id === client.status_id ? 'selected' : '' %>><%= s.name %></option>
        <% }) %>
      </select>
    </div>

    <div class="d-flex justify-content-end">
      <button class="btn btn-primary me-2" type="submit">Сохранить</button>
      <a class="btn btn-secondary" href="/clients">Отмена</a>
    </div>
  </form>
</div>

<%- include('../partials/footer') %>
